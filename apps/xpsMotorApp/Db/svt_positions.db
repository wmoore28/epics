# Database for SVT positions



record(ao,"$(pref)hps:svt_top:motionCondit"){
  field(DTYP,"Soft Channel")
  field(VAL,"0.1")
  field(SCAN, "Passive")
}
record(ao,"$(pref)hps:svt_top:home"){
  field(DTYP,"Soft Channel")
  field(VAL,"0.")
  field(PINI, "YES") 
  field(SCAN, "Passive")
  field(PREC, "3")
}
record(ao,"$(pref)hps:svt_top:home:proc"){
  field(DTYP,"Soft Channel")
  field(DOL,"$(pref)hps:svt_top:home")
  field(OMSL,"closed_loop")
  field(OUT,"$(pref)hps:svt_top:motor.VAL PP NMS")
  field(SCAN, "Passive")
}
record(calc, "$(pref)hps:svt_top_at_home") {
  field(INPA, "$(pref)hps:svt_top:motor.RBV")
  field(INPB, "$(pref)hps:svt_top:home")
  field(INPC, "$(pref)hps:svt_top:motor.DMOV")
  field(INPE, "$(pref)hps:svt_top:motionCondit")
  field(SCAN, ".2 second")
  field(CALC, "(ABS(A-B)<E)&&(C=1)?1:0")
}

record(ao,"$(pref)hps:svt_bot:motionCondit"){
  field(DTYP,"Soft Channel")
  field(VAL,"0.1")
  field(SCAN, "Passive")
}
record(ao,"$(pref)hps:svt_bot:home"){
  field(DTYP,"Soft Channel")
  field(VAL,"0.")
  field(PINI, "YES") 
  field(SCAN, "Passive")
  field(PREC, "3")
}
record(ao,"$(pref)hps:svt_bot:home:proc"){
  field(DTYP,"Soft Channel")
  field(DOL,"$(pref)hps:svt_bot:home")
  field(OMSL,"closed_loop")
  field(OUT,"$(pref)hps:svt_bot:motor.VAL PP NMS")
  field(SCAN, "Passive")
}
record(calc, "$(pref)hps:svt_bot_at_home") {
  field(INPA, "$(pref)hps:svt_bot:motor.RBV")
  field(INPB, "$(pref)hps:svt_bot:home")
  field(INPC, "$(pref)hps:svt_bot:motor.DMOV")
  field(INPE, "$(pref)hps:svt_bot:motionCondit")
  field(SCAN, ".2 second")
  field(CALC, "(ABS(A-B)<E)&&(C=1)?1:0")
}




record(calc, "$(pref)hps:svt:top:si") {
  field(DESC, "SVT Top Silicon position")
  field(PINI, "YES")
  field(CALC, "A*B+C")
  field(INPA, "$(pref)hps:svt_top:motor.RBV CPP")
#field(INPB, "-0.391")
#field(INPC, "7.472")
  field(INPB, "-0.4509")
  field(INPC, "8.6242")
  field(SCAN, "Passive")
  field(PREC, "3")
  field(EGU , "mm" )
}

record(calc, "$(pref)hps:svt:top:wire") {
  field(DESC, "SVT Top wire positions")
  field(PINI, "YES")
  field(CALC, "A*B+C")
  field(INPA, "$(pref)hps:svt_top:motor.RBV CPP")
#field(INPB, "-0.482")
#field(INPC, "1.218")
  field(INPB, "-0.4816")
  field(INPC, "1.0516")
  field(SCAN, "Passive")
  field(PREC, "3")
  field(EGU , "mm" )
}


record(calc, "$(pref)hps:svt:top:angle") {
  field(DESC, "SVT Top angle")
  field(PINI, "YES")
  field(CALC, "(B-A)/C")
  field(INPA, "$(pref)hps:svt_top:motor.RBV CPP")
#field(INPB, "17.821")
#field(INPC, "832.714")
  field(INPB, "18.017")
  field(INPC, "833.247")
  field(SCAN, "Passive")
  field(PREC, "4")
  field(EGU , "rad" )
}




record(calc, "$(pref)hps:svt:bot:si") {
  field(DESC, "SVT Bottom Silicon position")
  field(PINI, "YES")
  field(CALC, "A*B+C")
  field(INPA, "$(pref)hps:svt_bot:motor.RBV CPP")
#field(INPB, "0.363")
#field(INPC, "-6.815")
  field(INPB, "0.4227")
  field(INPC, "-8.215")
  field(SCAN, "Passive")
  field(PREC, "3")
  field(EGU , "mm" )
}

record(calc, "$(pref)hps:svt:bot:wire") {
  field(DESC, "SVT BOTTOM wire positions")
  field(PINI, "YES")
  field(CALC, "A*B+C")
  field(INPA, "$(pref)hps:svt_bot:motor.RBV CPP")
#field(INPB, "0.463")
#field(INPC, "-0.684")
  field(INPB, "0.4648")
  field(INPC, "-1.073")
  field(SCAN, "Passive")
  field(PREC, "3")
  field(EGU , "mm" )
}

record(calc, "$(pref)hps:svt:bot:angle") {
  field(DESC, "SVT Bottom angle")
  field(PINI, "YES")
  field(CALC, "(B-A)/C")
  field(INPA, "$(pref)hps:svt_bot:motor.RBV CPP")
#field(INPB, "17.397")
#field(INPC, "832.714")
  field(INPB, "18.250")
  field(INPC, "833.247")
  field(SCAN, "Passive")
  field(PREC, "4")
  field(EGU , "rad" )
}


record(calcout, "$(pref)hps:svt:top:si_calcout") {
  field(DESC, "Desired SVT top silicon position")
  field(SCAN, "Passive")
  field(PINI, "NO")
  field(CALC, "A*B+C")
  field(INPA, "$(pref)hps:svt:top:si_desired")
#field(INPB, "-2.556")
#field(INPC, "19.099")
  field(INPB, "-2.2178")
  field(INPC, "19.126")
  field(OUT, "$(pref)hps:svt_top:motor.VAL PP")
  field(OOPT, "Every Time")
  field(DOPT, "Use CALC")
  field(OCAL, "1")
}



record(calcout, "$(pref)hps:svt:bot:si_calcout") {
  field(DESC, "Desired SVT bottom silicon position")
  field(SCAN, "Passive")
  field(PINI, "NO")
  field(CALC, "A*B+C")
  field(INPA, "$(pref)hps:svt:bot:si_desired")
#field(INPB, "2.755")
#field(INPC, "18.775")
  field(INPB, "2.3657")
  field(INPC, "19.433")
  field(OUT, "$(pref)hps:svt_bot:motor.VAL PP")
  field(OOPT, "Every Time")
  field(DOPT, "Use CALC")
  field(OCAL, "1")
}


record( ai, "$(pref)hps:svt:top:si_desired" ) {
  field( EGU , "mm" )
  field( SCAN, "Passive" )
  field( DESC, "Desired value for top Si" )
  field( PREC, "3")
  field( SDIS, "$(pref)hps:svt:top:si_desired_sync.PACT" )
  field( FLNK, "$(pref)hps:svt:top:si_calcout PP" )
  field( DISV, "1" )
}

record( ai, "$(pref)hps:svt:bot:si_desired" ) {
  field( EGU , "mm" )
  field( SCAN, "Passive" )
  field( DESC, "Desired value for bot Si" )
  field( PREC, "3")
  field( SDIS, "$(pref)hps:svt:bot:si_desired_sync.PACT" )
  field( FLNK, "$(pref)hps:svt:bot:si_calcout PP")
  field( DISV, "1" )
}

record( ao, "$(pref)hps:svt:top:si_desired_sp" ) {
  field( EGU , "mm" )
  field( SCAN, "Passive" )
  field( DESC, "Desired value for top Si" )
  field( PREC, "3")
  field( OUT , "$(pref)hps:svt:top:si_desired NPP" ) 
  field( OMSL, "supervisory")
} 

record( ao, "$(pref)hps:svt:bot:si_desired_sp" ) {
  field( EGU , "mm" )
  field( SCAN, "Passive" )
  field( DESC, "Desired value for bot Si" )
  field( PREC, "3")
  field( OUT , "$(pref)hps:svt:bot:si_desired NPP")
  field( OMSL, "supervisory")
}

record( ao, "$(pref)hps:svt:top:si_desired_sync" ) {
  field( EGU , "mm" )
  field( SCAN, "Passive" )
  field( DESC, "Desired value for top Si" )
  field( PREC, "3")
  field( DOL , "$(pref)hps:svt:top:si CPP")
  field( OUT , "$(pref)hps:svt:top:si_desired_sp PP" ) 
  field( OMSL, "closed_loop")
} 

record( ao, "$(pref)hps:svt:bot:si_desired_sync" ) {
  field( EGU , "mm" )
  field( SCAN, "Passive" )
  field( DESC, "Desired value for bot Si" )
  field( PREC, "3")
  field( DOL , "$(pref)hps:svt:bot:si CPP")
  field( OUT , "$(pref)hps:svt:bot:si_desired_sp PP")
  field( OMSL, "closed_loop")
}
