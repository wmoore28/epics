# Database for target positions
#
# V.K.  July 16, 2012


record(ao,"$(pref)hps:target:motionCondit"){
  field(DTYP,"Soft Channel")
  field(VAL,"0.1")
  field(SCAN, "Passive")
}
record(ao,"$(pref)hps:target:home"){
  field(DTYP,"Soft Channel")
  field(VAL,"0.")
  field(PINI, "YES") 
  field(SCAN, "Passive")
  field(PREC, "3")
}
record(ao,"$(pref)hps:target:home:proc"){
  field(DTYP,"Soft Channel")
  field(DOL,"$(pref)hps:target:home")
  field(OMSL,"closed_loop")
  field(OUT,"$(pref)hps:target:motor.VAL PP NMS")
  field(SCAN, "Passive")
}
record(calc, "$(pref)hps:target_at_home") {
  field(INPA, "$(pref)hps:target:motor.RBV")
  field(INPB, "$(pref)hps:target:home")
  field(INPC, "$(pref)hps:target:motor.DMOV")
  field(INPE, "$(pref)hps:target:motionCondit")
  field(SCAN, ".2 second")
  field(CALC, "(ABS(A-B)<E)&&(C=1)?1:0")
}
record(ao,"$(pref)hps:target:a"){
  field(DTYP,"Soft Channel")
#field(VAL,"14.8455")
#field(VAL,"20.264")
  field(VAL,"16.264")
  field(PINI, "YES")
  field(SCAN, "Passive")
  field(PREC, "3")
}
record(ao,"$(pref)hps:target:a:proc"){
  field(DTYP,"Soft Channel")
  field(DOL,"$(pref)hps:target:a")
  field(OMSL,"closed_loop")
  field(OUT,"$(pref)hps:target:motor.VAL PP NMS")
  field(SCAN, "Passive")
}
record(calc, "$(pref)hps:target_at_a") {
  field(INPA, "$(pref)hps:target:motor.RBV")
  field(INPB, "$(pref)hps:target:a")
  field(INPC, "$(pref)hps:target:motor.DMOV")
  field(INPE, "$(pref)hps:target:motionCondit")
  field(SCAN, ".2 second")
  field(CALC, "(ABS(A-B)<E)&&(C=1)?1:0")
}
record(ao,"$(pref)hps:target:b"){
  field(DTYP,"Soft Channel")
#field(VAL,"24.764")
#field(VAL,"30.264")
  field(VAL,"26.2658")
  field(PINI, "YES")
  field(SCAN, "Passive")
  field(PREC, "3")
}
record(ao,"$(pref)hps:target:b:proc"){
  field(DTYP,"Soft Channel")
  field(DOL,"$(pref)hps:target:b")
  field(OMSL,"closed_loop")
  field(OUT,"$(pref)hps:target:motor.VAL PP NMS")
  field(SCAN, "Passive")
}
record(calc, "$(pref)hps:target_at_b") {
  field(INPA, "$(pref)hps:target:motor.RBV")
  field(INPB, "$(pref)hps:target:b")
  field(INPC, "$(pref)hps:target:motor.DMOV")
  field(INPE, "$(pref)hps:target:motionCondit")
  field(SCAN, ".2 second")
  field(CALC, "(ABS(A-B)<E)&&(C=1)?1:0")
}
record(ao,"$(pref)hps:target:c"){
  field(DTYP,"Soft Channel")
  field(VAL,"33.455")
  field(PINI, "YES")
  field(SCAN, "Passive")
  field(PREC, "3")

}
record(ao,"$(pref)hps:target:c:proc"){
  field(DTYP,"Soft Channel")
  field(DOL,"$(pref)hps:target:c")
  field(OMSL,"closed_loop")
  field(OUT,"$(pref)hps:target:motor.VAL PP NMS")
  field(SCAN, "Passive")
}
record(calc, "$(pref)hps:target_at_c") {
  field(INPA, "$(pref)hps:target:motor.RBV")
  field(INPB, "$(pref)hps:target:c")
  field(INPC, "$(pref)hps:target:motor.DMOV")
  field(INPE, "$(pref)hps:target:motionCondit")
  field(SCAN, ".2 second")
  field(CALC, "(ABS(A-B)<E)&&(C=1)?1:0")
}
record(ao,"$(pref)hps:target:d"){
  field(DTYP,"Soft Channel")
  field(VAL,"39.6745")
  field(PINI, "YES")
  field(SCAN, "Passive")
  field(PREC, "3")
}
record(ao,"$(pref)hps:target:d:proc"){
  field(DTYP,"Soft Channel")
  field(DOL,"$(pref)hps:target:d")
  field(OMSL,"closed_loop")
  field(OUT,"$(pref)hps:target:motor.VAL PP NMS")
  field(SCAN, "Passive")
}
record(calc, "$(pref)hps:target_at_d") {
  field(INPA, "$(pref)hps:target:motor.RBV")
  field(INPB, "$(pref)hps:target:d")
  field(INPC, "$(pref)hps:target:motor.DMOV")
  field(INPE, "$(pref)hps:target:motionCondit")
  field(SCAN, ".2 second")
  field(CALC, "(ABS(A-B)<E)&&(C=1)?1:0")
}

record(calcout,"$(pref)hps:target:calc") {
    field(SCAN,"5 second")
    field(INPA,"$(pref)hps:target_at_home")
    field(INPB,"$(pref)hps:target_at_a")
    field(INPC,"$(pref)hps:target_at_b")
    field(INPD,"$(pref)hps:target_at_c")
    field(INPE,"$(pref)hps:target_at_d")
    field(CALC,"A=1?0:(B=1?1:(C=1?2:(D=1?3:E=1?4:5)))")
    field(OUT,"$(pref)hps:target:type PP")
    field(OOPT,"Every Time")
    field(DOPT,"Use CALC")
}
record(mbbi,"$(pref)hps:target:type") {
    field(ZRVL,"0")
    field(ONVL,"1")
    field(TWVL,"2")
    field(THVL,"3")
    field(FRVL,"4")
    field(FVVL,"5")
    field(ZRST,"Empty")
    field(ONST,"8 um W")
    field(TWST,"20 um W")
    field(THST,"12C")
    field(FRST,"15 um W")
    field(FVST,"Unknown")
}

